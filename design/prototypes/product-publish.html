<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>发布商品 - Sapphire Mall</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'sapphire': {
                            50: '#eff6ff',
                            100: '#dbeafe', 
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        }
        .gradient-border {
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            padding: 2px;
            border-radius: 16px;
        }
        .gradient-border-content {
            background: #1f2937;
            border-radius: 14px;
            padding: 1.5rem;
        }
        .image-upload-area {
            border: 2px dashed #374151;
            transition: all 0.3s ease;
            min-height: 200px;
        }
        .image-upload-area:hover {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.05);
        }
        .image-upload-area.dragover {
            border-color: #8b5cf6;
            background: rgba(139, 92, 246, 0.1);
        }
        .uploaded-image {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
        }
        .remove-image {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(239, 68, 68, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .category-tag {
            transition: all 0.3s ease;
        }
        .category-tag:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        .category-tag.selected {
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            color: white;
        }
        .form-section {
            transition: all 0.3s ease;
        }
        .form-section:hover {
            transform: translateX(4px);
        }
    </style>
</head>
<body class="min-h-screen text-white">
    <!-- Header -->
    <nav class="bg-gray-900/50 backdrop-blur-sm border-b border-gray-700 sticky top-0 z-50">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-sapphire-500 to-purple-600 rounded-lg flex items-center justify-center">
                        <i class="fas fa-gem text-white text-lg"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold bg-gradient-to-r from-sapphire-400 to-purple-400 bg-clip-text text-transparent">Sapphire Mall</h1>
                        <p class="text-xs text-gray-400">发布商品</p>
                    </div>
                </div>

                <!-- User Status -->
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-2">
                        <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                        <span class="text-sm text-green-400">认证商家</span>
                        <i class="fas fa-check-circle text-green-400"></i>
                    </div>
                    <div class="bg-gray-800/50 rounded-lg px-4 py-2">
                        <div class="text-sm text-gray-400">0x742d...e6b7</div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-8">
        <div class="max-w-4xl mx-auto">
            <!-- Page Header -->
            <div class="text-center mb-8">
                <div class="w-20 h-20 bg-gradient-to-br from-sapphire-500 to-purple-600 rounded-full mx-auto mb-4 flex items-center justify-center">
                    <i class="fas fa-plus text-white text-3xl"></i>
                </div>
                <h2 class="text-3xl font-bold mb-4">发布新商品</h2>
                <p class="text-gray-400 text-lg max-w-2xl mx-auto">
                    创建您的虚拟商品清单，触达全球买家。支持多语言描述，智能定价建议。
                </p>
            </div>

            <form id="productForm" class="space-y-8">
                <!-- Basic Information -->
                <div class="form-section gradient-border">
                    <div class="gradient-border-content">
                        <h3 class="text-xl font-bold mb-6 flex items-center">
                            <i class="fas fa-info-circle text-sapphire-400 mr-3"></i>
                            基本信息
                        </h3>

                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="md:col-span-2">
                                <label class="block text-sm text-gray-400 mb-2">商品标题 *</label>
                                <input type="text" id="productTitle" placeholder="请输入商品标题，简洁明了" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-sapphire-500 focus:outline-none" required>
                                <p class="text-xs text-gray-500 mt-1">建议50字以内，包含关键词以提高搜索排名</p>
                            </div>

                            <div class="md:col-span-2">
                                <label class="block text-sm text-gray-400 mb-2">商品类别 *</label>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                    <div class="category-tag bg-gray-800 border border-gray-600 rounded-lg p-3 text-center cursor-pointer" onclick="selectCategory('gaming')">
                                        <i class="fas fa-gamepad text-2xl mb-2 text-purple-400"></i>
                                        <p class="text-sm font-medium">游戏道具</p>
                                    </div>
                                    <div class="category-tag bg-gray-800 border border-gray-600 rounded-lg p-3 text-center cursor-pointer" onclick="selectCategory('digital-art')">
                                        <i class="fas fa-palette text-2xl mb-2 text-pink-400"></i>
                                        <p class="text-sm font-medium">数字艺术</p>
                                    </div>
                                    <div class="category-tag bg-gray-800 border border-gray-600 rounded-lg p-3 text-center cursor-pointer" onclick="selectCategory('virtual-land')">
                                        <i class="fas fa-map text-2xl mb-2 text-green-400"></i>
                                        <p class="text-sm font-medium">虚拟土地</p>
                                    </div>
                                    <div class="category-tag bg-gray-800 border border-gray-600 rounded-lg p-3 text-center cursor-pointer" onclick="selectCategory('music')">
                                        <i class="fas fa-music text-2xl mb-2 text-blue-400"></i>
                                        <p class="text-sm font-medium">音乐作品</p>
                                    </div>
                                    <div class="category-tag bg-gray-800 border border-gray-600 rounded-lg p-3 text-center cursor-pointer" onclick="selectCategory('fashion')">
                                        <i class="fas fa-tshirt text-2xl mb-2 text-yellow-400"></i>
                                        <p class="text-sm font-medium">虚拟时装</p>
                                    </div>
                                    <div class="category-tag bg-gray-800 border border-gray-600 rounded-lg p-3 text-center cursor-pointer" onclick="selectCategory('collectibles')">
                                        <i class="fas fa-gem text-2xl mb-2 text-red-400"></i>
                                        <p class="text-sm font-medium">收藏品</p>
                                    </div>
                                    <div class="category-tag bg-gray-800 border border-gray-600 rounded-lg p-3 text-center cursor-pointer" onclick="selectCategory('domain')">
                                        <i class="fas fa-globe text-2xl mb-2 text-indigo-400"></i>
                                        <p class="text-sm font-medium">域名/账号</p>
                                    </div>
                                    <div class="category-tag bg-gray-800 border border-gray-600 rounded-lg p-3 text-center cursor-pointer" onclick="selectCategory('other')">
                                        <i class="fas fa-ellipsis-h text-2xl mb-2 text-gray-400"></i>
                                        <p class="text-sm font-medium">其他</p>
                                    </div>
                                </div>
                                <input type="hidden" id="selectedCategory" required>
                            </div>

                            <div>
                                <label class="block text-sm text-gray-400 mb-2">商品状态</label>
                                <select id="productCondition" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-sapphire-500 focus:outline-none">
                                    <option value="new">全新</option>
                                    <option value="like-new">近似全新</option>
                                    <option value="used">二手</option>
                                    <option value="vintage">古董/收藏</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm text-gray-400 mb-2">稀有度</label>
                                <select id="productRarity" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-sapphire-500 focus:outline-none">
                                    <option value="common">普通</option>
                                    <option value="uncommon">少见</option>
                                    <option value="rare">稀有</option>
                                    <option value="epic">史诗</option>
                                    <option value="legendary">传说</option>
                                    <option value="unique">唯一</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Product Images -->
                <div class="form-section gradient-border">
                    <div class="gradient-border-content">
                        <h3 class="text-xl font-bold mb-6 flex items-center">
                            <i class="fas fa-images text-sapphire-400 mr-3"></i>
                            商品图片
                        </h3>

                        <div class="grid md:grid-cols-2 gap-6">
                            <!-- Main Image Upload -->
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">主图 * （第一张图片将作为封面）</label>
                                <div class="image-upload-area p-8 text-center rounded-xl" id="mainImageUpload">
                                    <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                                    <p class="text-gray-400 mb-4">拖拽图片到此处或点击上传</p>
                                    <button type="button" onclick="uploadImage('main')" class="bg-sapphire-600 hover:bg-sapphire-700 text-white px-6 py-2 rounded-lg transition-colors">
                                        <i class="fas fa-upload mr-2"></i>选择图片
                                    </button>
                                    <p class="text-xs text-gray-500 mt-2">支持 JPG, PNG, GIF 格式，最大10MB</p>
                                </div>
                                <div id="mainImagePreview" class="mt-4 hidden">
                                    <div class="uploaded-image bg-gray-800 rounded-lg p-2">
                                        <img src="" alt="主图预览" class="w-full h-48 object-cover rounded">
                                        <button type="button" class="remove-image" onclick="removeImage('main')">
                                            <i class="fas fa-times text-xs"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Additional Images -->
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">附加图片 （最多5张）</label>
                                <div class="image-upload-area p-8 text-center rounded-xl" id="additionalImageUpload">
                                    <i class="fas fa-images text-4xl text-gray-400 mb-4"></i>
                                    <p class="text-gray-400 mb-4">展示商品的不同角度</p>
                                    <button type="button" onclick="uploadImage('additional')" class="bg-gray-700 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors">
                                        <i class="fas fa-plus mr-2"></i>添加图片
                                    </button>
                                </div>
                                <div id="additionalImagesPreview" class="mt-4 grid grid-cols-2 gap-2">
                                    <!-- Additional images will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Product Description -->
                <div class="form-section gradient-border">
                    <div class="gradient-border-content">
                        <h3 class="text-xl font-bold mb-6 flex items-center">
                            <i class="fas fa-align-left text-sapphire-400 mr-3"></i>
                            商品描述
                        </h3>

                        <!-- Language Tabs -->
                        <div class="flex space-x-4 mb-6">
                            <button type="button" onclick="switchLanguage('zh')" class="lang-tab px-4 py-2 rounded-lg bg-sapphire-600 text-white" id="tab-zh">
                                中文
                            </button>
                            <button type="button" onclick="switchLanguage('en')" class="lang-tab px-4 py-2 rounded-lg bg-gray-700 text-gray-300 hover:bg-gray-600" id="tab-en">
                                English
                            </button>
                        </div>

                        <!-- Chinese Description -->
                        <div id="desc-zh" class="language-content">
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm text-gray-400 mb-2">中文标题</label>
                                    <input type="text" id="titleZh" placeholder="请输入中文商品标题" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-sapphire-500 focus:outline-none">
                                </div>
                                <div>
                                    <label class="block text-sm text-gray-400 mb-2">中文描述</label>
                                    <textarea id="descriptionZh" rows="6" placeholder="详细描述您的商品，包括特色、功能、适用场景等..." class="w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-sapphire-500 focus:outline-none resize-none"></textarea>
                                    <p class="text-xs text-gray-500 mt-1">建议500-1000字，详细描述有助于提高成交率</p>
                                </div>
                            </div>
                        </div>

                        <!-- English Description -->
                        <div id="desc-en" class="language-content hidden">
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm text-gray-400 mb-2">English Title</label>
                                    <input type="text" id="titleEn" placeholder="Enter English product title" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-sapphire-500 focus:outline-none">
                                </div>
                                <div>
                                    <label class="block text-sm text-gray-400 mb-2">English Description</label>
                                    <textarea id="descriptionEn" rows="6" placeholder="Describe your product in detail, including features, functionality, use cases..." class="w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-sapphire-500 focus:outline-none resize-none"></textarea>
                                    <p class="text-xs text-gray-500 mt-1">Recommended 300-600 words for better conversion</p>
                                </div>
                            </div>
                        </div>

                        <!-- Tags -->
                        <div class="mt-6">
                            <label class="block text-sm text-gray-400 mb-2">标签 （用空格分隔）</label>
                            <input type="text" id="productTags" placeholder="例如: 游戏 皮肤 限定 王者荣耀" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-sapphire-500 focus:outline-none">
                            <p class="text-xs text-gray-500 mt-1">最多10个标签，有助于用户发现您的商品</p>
                        </div>
                    </div>
                </div>

                <!-- Pricing -->
                <div class="form-section gradient-border">
                    <div class="gradient-border-content">
                        <h3 class="text-xl font-bold mb-6 flex items-center">
                            <i class="fas fa-dollar-sign text-sapphire-400 mr-3"></i>
                            价格设置
                        </h3>

                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">销售价格 (SAP) *</label>
                                <div class="relative">
                                    <input type="number" id="productPrice" placeholder="0.00" step="0.01" min="0" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 pr-12 text-white focus:border-sapphire-500 focus:outline-none" required>
                                    <div class="absolute right-3 top-2 text-gray-400">SAP</div>
                                </div>
                                <div class="mt-2 text-sm text-gray-400">
                                    ≈ $<span id="usdPrice">0.00</span> USD
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm text-gray-400 mb-2">市场建议价格</label>
                                <div class="bg-gray-800/50 rounded-lg p-4">
                                    <div class="flex items-center justify-between mb-2">
                                        <span class="text-gray-400">类似商品均价</span>
                                        <span class="text-sapphire-400 font-semibold">235.50 SAP</span>
                                    </div>
                                    <div class="flex items-center justify-between mb-2">
                                        <span class="text-gray-400">建议定价范围</span>
                                        <span class="text-gray-300">200-280 SAP</span>
                                    </div>
                                    <button type="button" onclick="applyRecommendedPrice()" class="text-sapphire-400 text-sm hover:text-sapphire-300 transition-colors">
                                        <i class="fas fa-magic mr-1"></i>使用建议价格
                                    </button>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm text-gray-400 mb-2">销售类型</label>
                                <select id="saleType" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-sapphire-500 focus:outline-none" onchange="toggleAuctionSettings()">
                                    <option value="fixed">固定价格</option>
                                    <option value="auction">拍卖</option>
                                    <option value="offer">接受报价</option>
                                </select>
                            </div>

                            <div id="auctionSettings" class="hidden">
                                <label class="block text-sm text-gray-400 mb-2">拍卖结束时间</label>
                                <input type="datetime-local" id="auctionEndTime" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-sapphire-500 focus:outline-none">
                            </div>
                        </div>

                        <!-- Royalty Settings -->
                        <div class="mt-6 bg-gray-800/50 rounded-lg p-4">
                            <h4 class="font-semibold mb-4 flex items-center">
                                <i class="fas fa-percentage text-purple-400 mr-2"></i>
                                版税设置
                            </h4>
                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm text-gray-400 mb-2">创作者版税 (%)</label>
                                    <input type="number" id="royaltyPercentage" placeholder="5.0" step="0.1" min="0" max="20" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-sapphire-500 focus:outline-none">
                                    <p class="text-xs text-gray-500 mt-1">每次转售时您将获得此比例的版税</p>
                                </div>
                                <div>
                                    <label class="block text-sm text-gray-400 mb-2">版税收款地址</label>
                                    <input type="text" id="royaltyAddress" value="0x742d35Cc6484C43f556E5d1ea5B5cE2c59c1e6b7" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-sapphire-500 focus:outline-none">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Additional Settings -->
                <div class="form-section gradient-border">
                    <div class="gradient-border-content">
                        <h3 class="text-xl font-bold mb-6 flex items-center">
                            <i class="fas fa-cogs text-sapphire-400 mr-3"></i>
                            高级设置
                        </h3>

                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">库存数量</label>
                                <input type="number" id="stockQuantity" placeholder="1" min="1" value="1" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-sapphire-500 focus:outline-none">
                                <p class="text-xs text-gray-500 mt-1">设置可售数量，通常虚拟商品为1</p>
                            </div>

                            <div>
                                <label class="block text-sm text-gray-400 mb-2">上架时间</label>
                                <select id="listingSchedule" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-sapphire-500 focus:outline-none">
                                    <option value="immediate">立即上架</option>
                                    <option value="scheduled">定时上架</option>
                                </select>
                            </div>

                            <div class="md:col-span-2">
                                <label class="block text-sm text-gray-400 mb-2">交付方式</label>
                                <div class="space-y-3">
                                    <label class="flex items-center space-x-3">
                                        <input type="radio" name="deliveryMethod" value="automatic" class="text-sapphire-600 focus:ring-sapphire-500" checked>
                                        <span>自动交付 - 系统自动发送商品信息</span>
                                    </label>
                                    <label class="flex items-center space-x-3">
                                        <input type="radio" name="deliveryMethod" value="manual" class="text-sapphire-600 focus:ring-sapphire-500">
                                        <span>手动交付 - 买家联系后手动发送</span>
                                    </label>
                                    <label class="flex items-center space-x-3">
                                        <input type="radio" name="deliveryMethod" value="escrow" class="text-sapphire-600 focus:ring-sapphire-500">
                                        <span>托管交付 - 通过平台担保交易</span>
                                    </label>
                                </div>
                            </div>

                            <div class="md:col-span-2">
                                <label class="block text-sm text-gray-400 mb-2">交付说明</label>
                                <textarea id="deliveryInstructions" rows="3" placeholder="描述商品的交付方式、注意事项等..." class="w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-sapphire-500 focus:outline-none resize-none"></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Preview & Submit -->
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <button type="button" onclick="previewProduct()" class="border border-gray-600 text-gray-300 hover:text-white hover:border-sapphire-500 px-8 py-3 rounded-lg transition-colors">
                        <i class="fas fa-eye mr-2"></i>预览商品
                    </button>
                    <button type="button" onclick="saveDraft()" class="bg-gray-700 hover:bg-gray-600 text-white px-8 py-3 rounded-lg transition-colors">
                        <i class="fas fa-save mr-2"></i>保存草稿
                    </button>
                    <button type="submit" class="bg-gradient-to-r from-sapphire-500 to-purple-600 text-white px-8 py-3 rounded-lg hover:from-sapphire-600 hover:to-purple-700 transition-all duration-300">
                        <i class="fas fa-rocket mr-2"></i>发布商品
                    </button>
                </div>
            </form>
        </div>
    </main>

    <!-- Hidden File Input -->
    <input type="file" id="fileInput" accept="image/*" multiple style="display: none;" onchange="handleFileSelect(event)">

    <script>
        let currentUploadType = '';
        let selectedCategory = '';
        let currentLanguage = 'zh';
        let uploadedImages = {
            main: null,
            additional: []
        };

        const SAP_TO_USD = 0.408; // SAP price in USD

        function selectCategory(category) {
            selectedCategory = category;
            document.getElementById('selectedCategory').value = category;
            
            // Update UI
            document.querySelectorAll('.category-tag').forEach(tag => {
                tag.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            
            showToast('已选择分类: ' + getCategoryName(category));
        }

        function getCategoryName(category) {
            const names = {
                'gaming': '游戏道具',
                'digital-art': '数字艺术',
                'virtual-land': '虚拟土地',
                'music': '音乐作品',
                'fashion': '虚拟时装',
                'collectibles': '收藏品',
                'domain': '域名/账号',
                'other': '其他'
            };
            return names[category] || category;
        }

        function uploadImage(type) {
            currentUploadType = type;
            const fileInput = document.getElementById('fileInput');
            
            if (type === 'additional') {
                fileInput.multiple = true;
            } else {
                fileInput.multiple = false;
            }
            
            fileInput.click();
        }

        function handleFileSelect(event) {
            const files = Array.from(event.target.files);
            
            if (currentUploadType === 'main' && files.length > 0) {
                uploadMainImage(files[0]);
            } else if (currentUploadType === 'additional') {
                uploadAdditionalImages(files);
            }
            
            // Reset input
            event.target.value = '';
        }

        function uploadMainImage(file) {
            if (!validateImage(file)) return;
            
            showToast('正在上传主图...', 'info');
            
            setTimeout(() => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    uploadedImages.main = {
                        file: file,
                        url: e.target.result
                    };
                    
                    showMainImagePreview(e.target.result);
                    showToast('主图上传成功！', 'success');
                };
                reader.readAsDataURL(file);
            }, 1500);
        }

        function uploadAdditionalImages(files) {
            if (uploadedImages.additional.length + files.length > 5) {
                showToast('最多只能上传5张附加图片', 'error');
                return;
            }
            
            files.forEach(file => {
                if (!validateImage(file)) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    uploadedImages.additional.push({
                        file: file,
                        url: e.target.result
                    });
                    
                    updateAdditionalImagesPreview();
                };
                reader.readAsDataURL(file);
            });
            
            showToast(`正在上传${files.length}张图片...`, 'info');
        }

        function showMainImagePreview(imageUrl) {
            const uploadArea = document.getElementById('mainImageUpload');
            const preview = document.getElementById('mainImagePreview');
            const img = preview.querySelector('img');
            
            uploadArea.classList.add('hidden');
            preview.classList.remove('hidden');
            img.src = imageUrl;
        }

        function updateAdditionalImagesPreview() {
            const container = document.getElementById('additionalImagesPreview');
            container.innerHTML = '';
            
            uploadedImages.additional.forEach((image, index) => {
                const div = document.createElement('div');
                div.className = 'uploaded-image bg-gray-800 rounded-lg p-2';
                div.innerHTML = `
                    <img src="${image.url}" alt="附加图片${index + 1}" class="w-full h-24 object-cover rounded">
                    <button type="button" class="remove-image" onclick="removeAdditionalImage(${index})">
                        <i class="fas fa-times text-xs"></i>
                    </button>
                `;
                container.appendChild(div);
            });
        }

        function removeImage(type) {
            if (type === 'main') {
                uploadedImages.main = null;
                document.getElementById('mainImageUpload').classList.remove('hidden');
                document.getElementById('mainImagePreview').classList.add('hidden');
                showToast('已删除主图');
            }
        }

        function removeAdditionalImage(index) {
            uploadedImages.additional.splice(index, 1);
            updateAdditionalImagesPreview();
            showToast('已删除图片');
        }

        function validateImage(file) {
            if (!file.type.includes('image/')) {
                showToast('请选择图片文件', 'error');
                return false;
            }
            
            if (file.size > 10 * 1024 * 1024) {
                showToast('图片大小不能超过10MB', 'error');
                return false;
            }
            
            return true;
        }

        function switchLanguage(lang) {
            currentLanguage = lang;
            
            // Update tabs
            document.querySelectorAll('.lang-tab').forEach(tab => {
                tab.classList.remove('bg-sapphire-600', 'text-white');
                tab.classList.add('bg-gray-700', 'text-gray-300');
            });
            document.getElementById(`tab-${lang}`).classList.remove('bg-gray-700', 'text-gray-300');
            document.getElementById(`tab-${lang}`).classList.add('bg-sapphire-600', 'text-white');
            
            // Update content
            document.querySelectorAll('.language-content').forEach(content => {
                content.classList.add('hidden');
            });
            document.getElementById(`desc-${lang}`).classList.remove('hidden');
        }

        function toggleAuctionSettings() {
            const saleType = document.getElementById('saleType').value;
            const auctionSettings = document.getElementById('auctionSettings');
            
            if (saleType === 'auction') {
                auctionSettings.classList.remove('hidden');
            } else {
                auctionSettings.classList.add('hidden');
            }
        }

        function applyRecommendedPrice() {
            document.getElementById('productPrice').value = '235.50';
            updateUSDPrice();
            showToast('已应用建议价格: 235.50 SAP');
        }

        function updateUSDPrice() {
            const sapPrice = parseFloat(document.getElementById('productPrice').value) || 0;
            const usdPrice = (sapPrice * SAP_TO_USD).toFixed(2);
            document.getElementById('usdPrice').textContent = usdPrice;
        }

        function previewProduct() {
            showToast('商品预览功能开发中...', 'info');
        }

        function saveDraft() {
            showToast('正在保存草稿...', 'info');
            
            setTimeout(() => {
                showToast('草稿保存成功！', 'success');
            }, 1500);
        }

        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `fixed top-4 right-4 z-50 px-6 py-3 rounded-lg text-white transition-all duration-300 transform translate-x-full`;
            
            if (type === 'success') {
                toast.classList.add('bg-green-600');
            } else if (type === 'error') {
                toast.classList.add('bg-red-600');
            } else {
                toast.classList.add('bg-sapphire-600');
            }
            
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => toast.classList.remove('translate-x-full'), 100);
            setTimeout(() => {
                toast.classList.add('translate-x-full');
                setTimeout(() => document.body.removeChild(toast), 300);
            }, 3000);
        }

        // Event Listeners
        document.getElementById('productPrice').addEventListener('input', updateUSDPrice);

        document.getElementById('productForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Validate required fields
            if (!uploadedImages.main) {
                showToast('请上传商品主图', 'error');
                return;
            }
            
            if (!selectedCategory) {
                showToast('请选择商品类别', 'error');
                return;
            }
            
            const title = document.getElementById('productTitle').value.trim();
            const price = document.getElementById('productPrice').value;
            
            if (!title) {
                showToast('请输入商品标题', 'error');
                return;
            }
            
            if (!price || parseFloat(price) <= 0) {
                showToast('请设置有效的价格', 'error');
                return;
            }
            
            // Simulate product publishing
            showToast('正在发布商品...', 'info');
            
            setTimeout(() => {
                showToast('商品发布成功！正在跳转到商品页面...', 'success');
                
                setTimeout(() => {
                    showToast('发布成功！商品编号: #SP' + Date.now().toString().slice(-6));
                }, 2000);
            }, 3000);
        });

        // Drag and drop functionality
        document.addEventListener('DOMContentLoaded', function() {
            const uploadAreas = document.querySelectorAll('.image-upload-area');
            
            uploadAreas.forEach(area => {
                area.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.classList.add('dragover');
                });
                
                area.addEventListener('dragleave', function(e) {
                    e.preventDefault();
                    this.classList.remove('dragover');
                });
                
                area.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.classList.remove('dragover');
                    
                    const files = Array.from(e.dataTransfer.files);
                    const validFiles = files.filter(file => file.type.includes('image/'));
                    
                    if (validFiles.length === 0) {
                        showToast('请拖拽图片文件', 'error');
                        return;
                    }
                    
                    // Determine upload type based on which area was dropped on
                    if (this.id === 'mainImageUpload') {
                        currentUploadType = 'main';
                        if (validFiles.length > 0) {
                            uploadMainImage(validFiles[0]);
                        }
                    } else if (this.id === 'additionalImageUpload') {
                        currentUploadType = 'additional';
                        uploadAdditionalImages(validFiles);
                    }
                });
            });
            
            // Initialize USD price
            updateUSDPrice();
        });
    </script>
</body>
</html> 